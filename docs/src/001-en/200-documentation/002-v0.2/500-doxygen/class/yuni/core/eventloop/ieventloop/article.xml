<title>IEventLoop</title>
<pragma:weight value="0.5" />
<pragma:toc visible="false" />
<tag name="doxygen" />
<tag name="dox:class" />



<h2>A Synchronous Event Demultiplexer (Reactor pattern)</h2>
<h3>Public typedef</h3>
<div class="doxygen_brief"><table class="nostyle"><tr><td></td><td><h4></h4></td></tr>
<tr><td class="doxygen_index"><code><span class="keyword">typedef</span></code></td><td class="doxygen_index_def"><code><span class="method"><a name="#classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1a7f170bf0cfbe46f52f55fb8730cd85fb" href="#">ParentType</a></span> : ParentT</code></td></tr>
<tr><td class="doxygen_index"><code><span class="keyword">typedef</span></code></td><td class="doxygen_index_def"><code><span class="method"><a name="#classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1a30d9e5e444c67693127986369c8d3b18" href="#">RequestType</a></span> : Bind&lt;bool()&gt;</code></td></tr>
<tr><td class="doxygen_index"><code><span class="keyword">typedef</span></code></td><td class="doxygen_index_def"><code><span class="method"><a name="#classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1a01008347f39f886f8ee34fd209290adb" href="#">RequestListType</a></span> : LinkedList&lt;RequestType&gt;</code></td></tr>
<tr><td class="doxygen_index"><code><span class="keyword">typedef</span></code></td><td class="doxygen_index_def"><code><span class="method"><a name="#classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1a3285c9a347620895d27b405c4b55a760" href="#">EventLoopType</a></span> : IEventLoop&lt;ParentType, FlowT, StatsT, DetachedT&gt;</code></td></tr>
<tr><td class="doxygen_index"><code><span class="keyword">typedef</span></code></td><td class="doxygen_index_def"><code><span class="method"><a name="#classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1a92176b87ccd4568d33e43b2eb790b0fe" href="#">Ptr</a></span> : SmartPtr&lt;EventLoopType&gt;</code></td></tr>
<tr><td class="doxygen_index"><code><span class="keyword">typedef</span></code></td><td class="doxygen_index_def"><code><span class="method"><a name="#classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1ac1566b70c198d7d14ab6a7b6e7217fb8" href="#">ThreadingPolicy</a></span> : Policy::ObjectLevelLockableNotRecursive&lt;EventLoopType&gt;</code></td></tr>
<tr><td class="doxygen_index"><code><span class="keyword">typedef</span></code></td><td class="doxygen_index_def"><code><span class="method"><a name="#classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1a9f9df9b4d3638a40dda76795ac165683" href="#">ThreadType</a></span> : Yuni::Private::Core::EventLoop::Thread&lt; EventLoopType&gt;</code></td></tr>
<tr><td class="doxygen_index"><code><span class="keyword">typedef</span></code></td><td class="doxygen_index_def"><code><span class="method"><a name="#classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1ab12dc79c0130e3576a536ba91e005b68" href="#">FlowPolicy</a></span> : FlowT&lt; EventLoopType&gt;</code></td></tr>
<tr><td class="doxygen_index"><code><span class="keyword">typedef</span></code></td><td class="doxygen_index_def"><code><span class="method"><a name="#classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1ae78bd2a663d9e45a9380f5c968bebfec" href="#">StatisticsPolicy</a></span> : StatsT&lt; EventLoopType&gt;</code></td></tr>
</table></div>

<h3>Public function</h3>
<div class="doxygen_brief"><table class="nostyle"><tr><td></td><td><h4>Constructor &amp; Destructor</h4></td></tr>
<tr><td class="doxygen_index"><code> </code></td><td class="doxygen_index_def"><code> <span class="method"><a href="#classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1a8a8f3ebd5c097c45012040b757b3e6c5">IEventLoop</a></span>()</code></td></tr>
<tr><td class="doxygen_index"><code> </code></td><td class="doxygen_index_def"><code> <span class="method"><a href="#classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1a18349eca64a10311c73c2e8c0d58df81"><b> ~ </b>IEventLoop</a></span>()</code></td></tr>
<tr><td></td><td><br /><h4>Operators</h4></td></tr>
<tr><td class="doxygen_index"><code>IEventLoop&amp; </code></td><td class="doxygen_index_def"><code> <span class="method"><a href="#classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1abe699d97cf9d2088089a7281848bcde0">operator+=</a></span>(const RequestType&amp; request)</code></td></tr>
<tr><td class="doxygen_index"><code>IEventLoop&amp; </code></td><td class="doxygen_index_def"><code> <span class="method"><a href="#classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1a963a5632e9ecd5d84d7faeac149d8e5f">operator&lt;&lt;</a></span>(const RequestType&amp; request)</code></td></tr>
<tr><td></td><td><br /><h4></h4></td></tr>
<tr><td class="doxygen_index"><code>void </code></td><td class="doxygen_index_def"><code> <span class="method"><a href="#classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1a126e3a21fa7861dc19748c4ca5df7a99">start</a></span>()</code></td></tr>
<tr><td class="doxygen_index"><code>void </code></td><td class="doxygen_index_def"><code> <span class="method"><a href="#classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1a1411bb43efed973cc100c12355e689e3">stop</a></span>(unsigned int timeout)</code></td></tr>
<tr><td class="doxygen_index"><code>void </code></td><td class="doxygen_index_def"><code> <span class="method"><a href="#classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1ac7cead9d8c26b6d259265242aa51ced8">dispatch</a></span>(const RequestType&amp; request)</code></td></tr>
<tr><td></td><td><br /><h4></h4></td></tr>
<tr><td class="doxygen_index"><code><span class="keyword">static</span> bool </code></td><td class="doxygen_index_def"><code> <span class="method"><a href="#classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1a6dcc16536a8a0ea7820ba2127d36b0b5">onLoop</a></span>()</code></td></tr>
</table></div>

<h3>Protected function</h3>
<div class="doxygen_brief"><table class="nostyle"><tr><td></td><td><h4></h4></td></tr>
<tr><td class="doxygen_index"><code>void </code></td><td class="doxygen_index_def"><code> <span class="method"><a href="#classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1abf588c6230d70bc1fc855abd75664411">suspend</a></span>(unsigned int timeout)</code></td></tr>
</table></div>

<h2>Detailed Description</h2><div>This class handles requests (from any thread or process) from a single thread. It is designed to run code that can not be thread-safe, like calls to OpenGL or OpenAL routines. If those requests must be run from the main thread (e.g. OpenGL), the event loop must not be detached (see the template parameter 'DetachedT') and the method 'start()' must be executed from the main thread.<br /> Here is a sample to create a minimalist event loop<source type="cpp">  class  MyEventLoop  :  public  Core::EventLoop:: IEventLoop &lt;MyEventLoop&gt;
  {
  public :
     bool  onLoop ()
     {
         std::cout  &lt;&lt;  "loop  !\n" ;
     }
  };
</source>
<br /><div class="doxygen_params">Parameters :</div><ul><li><code> ParentT</code> The parent class (CRTP)<br /></li><li><code> FlowT</code> The flow policy<br /></li><li><code> StatsT</code> The statistics policy<br /></li><li><code> DetechedT</code> A non-zero value to use a separate thread than the calling one for running the event loop. This value should always be true for code safety unless that you want to execute the event loop from the calling thread (e.g. the main thread). In this case, you _have_ to take care about blocking system calls that would prevent the loop to stop.<br /></li></ul><br /></div><div style="margin-top:3em;border:1px solid #aaa;border-bottom-style:none;border-left-style:none;border-right-style:none"></div>
<table class="doxygen_table">
<tr><td class="doxnone"></td><td class="doxnone"><h3 class="doxygen_section">Public <code class="doxygen_visibility">Public</code></h3>
</td></tr>
<tr><td class="doxygen_enum"></td><td class="doxnone"><div class="doxygen_brief"><code><i>(unmanaged tag: 4)</i></code>
</div></td></tr><tr><td class="doxnone doxreturn"></td><td class="doxnone">
<div class="doxygen_name_spacer"></div>
<div class="doxygen_desc">
</div>
</td></tr>
<tr><td class="doxygen_typedef"></td><td class="doxnone"><div class="doxygen_brief"><b>Parent.<br /></b><div class="doxygen_name_spacer"></div>
<code><span class="method"><a name="classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1a7f170bf0cfbe46f52f55fb8730cd85fb" href="#">+ ParentType</a></span>: <span class="keyword">typedef</span> ParentT;
</code>
</div></td></tr><tr><td class="doxnone doxreturn"></td><td class="doxnone">
<div class="doxygen_name_spacer"></div>
<div class="doxygen_desc">
</div>
</td></tr>
<tr><td class="doxygen_typedef"></td><td class="doxnone"><div class="doxygen_brief"><b>A request.<br /></b><div class="doxygen_name_spacer"></div>
<code><span class="method"><a name="classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1a30d9e5e444c67693127986369c8d3b18" href="#">+ RequestType</a></span>: <span class="keyword">typedef</span> Bind&lt;bool()&gt;;
</code>
</div></td></tr><tr><td class="doxnone doxreturn"></td><td class="doxnone">
<div class="doxygen_name_spacer"></div>
<div class="doxygen_desc">
</div>
</td></tr>
<tr><td class="doxygen_typedef"></td><td class="doxnone"><div class="doxygen_brief"><b>List of requests.<br /></b><div class="doxygen_name_spacer"></div>
<code><span class="method"><a name="classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1a01008347f39f886f8ee34fd209290adb" href="#">+ RequestListType</a></span>: <span class="keyword">typedef</span> LinkedList&lt;RequestType&gt;;
</code>
</div></td></tr><tr><td class="doxnone doxreturn"></td><td class="doxnone">
<div class="doxygen_name_spacer"></div>
<div class="doxygen_desc">
</div>
</td></tr>
<tr><td class="doxygen_typedef"></td><td class="doxnone"><div class="doxygen_brief"><b>The Event loop.<br /></b><div class="doxygen_name_spacer"></div>
<code><span class="method"><a name="classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1a3285c9a347620895d27b405c4b55a760" href="#">+ EventLoopType</a></span>: <span class="keyword">typedef</span> IEventLoop&lt;ParentType, FlowT, StatsT, DetachedT&gt;;
</code>
</div></td></tr><tr><td class="doxnone doxreturn"></td><td class="doxnone">
<div class="doxygen_name_spacer"></div>
<div class="doxygen_desc">
</div>
</td></tr>
<tr><td class="doxygen_typedef"></td><td class="doxnone"><div class="doxygen_brief"><b>The most suitable smart pointer for the class.<br /></b><div class="doxygen_name_spacer"></div>
<code><span class="method"><a name="classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1a92176b87ccd4568d33e43b2eb790b0fe" href="#">+ Ptr</a></span>: <span class="keyword">typedef</span> SmartPtr&lt;EventLoopType&gt;;
</code>
</div></td></tr><tr><td class="doxnone doxreturn"></td><td class="doxnone">
<div class="doxygen_name_spacer"></div>
<div class="doxygen_desc">
</div>
</td></tr>
<tr><td class="doxygen_typedef"></td><td class="doxnone"><div class="doxygen_brief"><b>The threading policy.<br /></b><div class="doxygen_name_spacer"></div>
<code><span class="method"><a name="classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1ac1566b70c198d7d14ab6a7b6e7217fb8" href="#">+ ThreadingPolicy</a></span>: <span class="keyword">typedef</span> Policy::ObjectLevelLockableNotRecursive&lt;EventLoopType&gt;;
</code>
</div></td></tr><tr><td class="doxnone doxreturn"></td><td class="doxnone">
<div class="doxygen_name_spacer"></div>
<div class="doxygen_desc">
</div>
</td></tr>
<tr><td class="doxygen_typedef"></td><td class="doxnone"><div class="doxygen_brief"><b>The thread used for the inner loop.<br /></b><div class="doxygen_name_spacer"></div>
<code><span class="method"><a name="classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1a9f9df9b4d3638a40dda76795ac165683" href="#">+ ThreadType</a></span>: <span class="keyword">typedef</span> Yuni::Private::Core::EventLoop::Thread&lt; EventLoopType&gt;;
</code>
</div></td></tr><tr><td class="doxnone doxreturn"></td><td class="doxnone">
<div class="doxygen_name_spacer"></div>
<div class="doxygen_desc">
</div>
</td></tr>
<tr><td class="doxygen_typedef"></td><td class="doxnone"><div class="doxygen_brief"><b>The flow policy.<br /></b><div class="doxygen_name_spacer"></div>
<code><span class="method"><a name="classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1ab12dc79c0130e3576a536ba91e005b68" href="#">+ FlowPolicy</a></span>: <span class="keyword">typedef</span> FlowT&lt; EventLoopType&gt;;
</code>
</div></td></tr><tr><td class="doxnone doxreturn"></td><td class="doxnone">
<div class="doxygen_name_spacer"></div>
<div class="doxygen_desc">
</div>
</td></tr>
<tr><td class="doxygen_typedef"></td><td class="doxnone"><div class="doxygen_brief"><b>The statistics policy.<br /></b><div class="doxygen_name_spacer"></div>
<code><span class="method"><a name="classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1ae78bd2a663d9e45a9380f5c968bebfec" href="#">+ StatisticsPolicy</a></span>: <span class="keyword">typedef</span> StatsT&lt; EventLoopType&gt;;
</code>
</div></td></tr><tr><td class="doxnone doxreturn"></td><td class="doxnone">
<div class="doxygen_name_spacer"></div>
<div class="doxygen_desc">
</div>
</td></tr>
<tr><td class="doxygen_enum"></td><td class="doxnone"><div class="doxygen_brief"><b>Get if this policy is thread-safe.<br /></b><div class="doxygen_name_spacer"></div>
<code><i>(unmanaged tag: 4)</i></code>
</div></td></tr><tr><td class="doxnone doxreturn"></td><td class="doxnone">
<div class="doxygen_name_spacer"></div>
<div class="doxygen_desc">
</div>
</td></tr>
<tr><td class="doxnone"></td><td class="doxnone"><h3 class="doxygen_section">Constructor &amp; Destructor <code class="doxygen_visibility">Public</code></h3>
</td></tr>
<tr><td class="doxygen_fun"></td><td class="doxnone"><div class="doxygen_brief"><b>Default constructor.<br /></b><div class="doxygen_name_spacer"></div>
<code> <span class="method"><a name="classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1a8a8f3ebd5c097c45012040b757b3e6c5" href="#">+ IEventLoop</a></span>:  ();
</code>
</div></td></tr><tr><td class="doxnone doxreturn"></td><td class="doxnone">
<div class="doxygen_name_spacer"></div>
<div class="doxygen_desc">
</div>
</td></tr>
<tr><td class="doxygen_fun"></td><td class="doxnone"><div class="doxygen_brief"><b>Destructor.<br /></b><div class="doxygen_name_spacer"></div>
<code> <span class="method"><a name="classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1a18349eca64a10311c73c2e8c0d58df81" href="#">+ <b> ~ </b>IEventLoop</a></span>:  ();
</code>
</div></td></tr><tr><td class="doxnone doxreturn"></td><td class="doxnone">
<div class="doxygen_name_spacer"></div>
<div class="doxygen_desc">
</div>
</td></tr>
<tr><td class="doxnone"></td><td class="doxnone"><h3 class="doxygen_section">Operators <code class="doxygen_visibility">Public</code></h3>
</td></tr>
<tr><td class="doxygen_fun"></td><td class="doxnone"><div class="doxygen_brief"><b>The operator += : Dispatch a new request.<br /></b><div class="doxygen_name_spacer"></div>
<code> <span class="method"><a name="classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1abe699d97cf9d2088089a7281848bcde0" href="#">+ operator+=</a></span>: IEventLoop&amp; (const RequestType&amp; request);
</code>
</div></td></tr><tr><td class="doxnone doxreturn"></td><td class="doxnone">
<div class="doxygen_name_spacer"></div>
<div class="doxygen_desc">
</div>
</td></tr>
<tr><td class="doxygen_fun"></td><td class="doxnone"><div class="doxygen_brief"><b>The operator &lt;&lt; : Dispatch a new request.<br /></b><div class="doxygen_name_spacer"></div>
<code> <span class="method"><a name="classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1a963a5632e9ecd5d84d7faeac149d8e5f" href="#">+ operator&lt;&lt;</a></span>: IEventLoop&amp; (const RequestType&amp; request);
</code>
</div></td></tr><tr><td class="doxnone doxreturn"></td><td class="doxnone">
<div class="doxygen_name_spacer"></div>
<div class="doxygen_desc">
</div>
</td></tr>
<tr><td class="doxnone"></td><td class="doxnone"><h3 class="doxygen_section">Public <code class="doxygen_visibility">Public</code></h3>
</td></tr>
<tr><td class="doxygen_fun"></td><td class="doxnone"><div class="doxygen_brief"><b>Start the event loop.<br /></b><div class="doxygen_name_spacer"></div>
<code> <span class="method"><a name="classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1a126e3a21fa7861dc19748c4ca5df7a99" href="#">+ start</a></span>: void ();
</code>
</div></td></tr><tr><td class="doxnone doxreturn"></td><td class="doxnone">
<div class="doxygen_name_spacer"></div>
<div class="doxygen_desc">This method will be non-blocking in detached mode and the event loop will be ran from another thread. Otherwise it will block until the loop is stopped by a call to `stop()` from another thread or a request that had failed.<br />
</div>
</td></tr>
<tr><td class="doxygen_fun"></td><td class="doxnone"><div class="doxygen_brief"><b>Gracefully stop the execution of the event loop, and wait for it.<br /></b><div class="doxygen_name_spacer"></div>
<code> <span class="method"><a name="classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1a1411bb43efed973cc100c12355e689e3" href="#">+ stop</a></span>: void (unsigned int timeout);
</code>
</div></td></tr><tr><td class="doxnone doxreturn"></td><td class="doxnone">
<div class="doxygen_name_spacer"></div>
<div class="doxygen_desc">In detached mode, the method will wait for the end of the execution of the detached thread, and will kill it if the timeout expires. When the event loop is not detached, there is no guarantee that the event loop is really stopped after the call to this method, since there is no control on the thread that had called start() .<br /><div class="doxygen_params">Parameters :</div><ul><li><code> timeout</code> The number of milliseconds to wait before killing the event loop<br /></li></ul><br />
</div>
</td></tr>
<tr><td class="doxygen_fun"></td><td class="doxnone"><div class="doxygen_brief"><b>Post a new request into the queue.<br /></b><div class="doxygen_name_spacer"></div>
<code> <span class="method"><a name="classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1ac7cead9d8c26b6d259265242aa51ced8" href="#">+ dispatch</a></span>: void (const RequestType&amp; request);
</code>
</div></td></tr><tr><td class="doxnone doxreturn"></td><td class="doxnone">
<div class="doxygen_name_spacer"></div>
<div class="doxygen_desc"><div class="doxygen_params">Parameters :</div><ul><li><code> request</code> A request, which is merely a delegate via the class Bind&lt;&gt;)<br /></li></ul><br />
</div>
</td></tr>
<tr><td class="doxnone"></td><td class="doxnone"><h3 class="doxygen_section">Public <code class="doxygen_visibility">Public</code></h3>
</td></tr>
<tr><td class="doxygen_fun"></td><td class="doxnone"><div class="doxygen_brief"><b>On loop event handler.<br /></b><div class="doxygen_name_spacer"></div>
<code> <span class="method"><a name="classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1a6dcc16536a8a0ea7820ba2127d36b0b5" href="#">+ onLoop</a></span>: <span class="keyword">static</span> bool ();
</code>
</div></td></tr><tr><td class="doxnone doxreturn"></td><td class="doxnone">
<div class="doxygen_name_spacer"></div>
<div class="doxygen_desc"><div><b>warning</b> :  Has to be redefined by children classes !<br /></div><div><code>return</code>  False to stop the loop<br /></div><br />
</div>
</td></tr>
<tr><td class="doxnone"></td><td class="doxnone"><h3 class="doxygen_section">Protected <code class="doxygen_visibility">Protected</code></h3>
</td></tr>
<tr><td class="doxygen_fun"></td><td class="doxnone"><div class="doxygen_brief"><b>Suspend the thread.<br /></b><div class="doxygen_name_spacer"></div>
<code> <span class="method"><a name="classYuni_1_1Core_1_1EventLoop_1_1IEventLoop_1abf588c6230d70bc1fc855abd75664411" href="#"># suspend</a></span>: void (unsigned int timeout);
</code>
</div></td></tr><tr><td class="doxnone doxreturn"></td><td class="doxnone">
<div class="doxygen_name_spacer"></div>
<div class="doxygen_desc">
</div>
</td></tr>
<tr><td class="doxnone"></td><td class="doxnone"><h3 class="doxygen_section">Protected <code class="doxygen_visibility">Protected</code></h3>
</td></tr>
<tr><td class="doxygen_var"></td><td class="doxnone"><div class="doxygen_brief"><b>Mutex.<br /></b><div class="doxygen_name_spacer"></div>
<code><span class="method"><a href="#"># pMutex</a></span>: Mutex;</code>
</div></td></tr><tr><td class="doxnone doxreturn"></td><td class="doxnone">
<div class="doxygen_name_spacer"></div>
<div class="doxygen_desc">
</div>
</td></tr>
</table>


